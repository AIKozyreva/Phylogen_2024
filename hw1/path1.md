## Mito Eve HW1

Task1: https://docs.google.com/document/d/1uV-HjQk-K1WCGMnkjM_lkI4p4QMIK8H3qZJAHX2oQVI/edit 

my_workdir: /mnt/.../kozyreva_works/230924_phylo_hw/human_mt_haplo

Raw_input_data: https://figshare.com/ndownloader/files/30768763 
 
Neanderthal samples: https://figshare.com/ndownloader/files/30768766 

Denisovan samples: https://figshare.com/ndownloader/files/30768775 

 ### Step1
 Создание окружения, установка mafft, iqtree2, jupyterlab. 
```
conda create -n phylo_hw
conda activate phylo_hw
conda install -c bioconda mafft
conda install -c bioconda iqtree2
conda install -c bioconda jupyterlab
```
### Step2
В директории human_mt_haplo, которую мы скачали из {Raw_input_data} лежит несколько .fasta. Чтобы выровнять все друг на друга, нужно сделать мультивыравнивание, для него нужна мультифаста - это когда несколько фаст просто конкатенируют вместе. Сначал мы создадим такую общую combined.fasta, а потом проведём выравнивание by mafft.

```
cat human_mt_haplo/*.fasta > comb_hum_mt_haplo.fasta
grep -c ">" comb_hum_mt_haplo.fasta #получим 45 по количеству входных .fasta файлов
```

```
mafft --kimura 1 --clustalout --maxiterate 1000 --thread 8 --auto comb_hum_mt_haplo.fasta > hum_MT_haplo.aln
```

Параметры: `--kimura 1` - позволяет скорректировать построенное выравнивание с учётом того, что в биологии транзиции (пурин-пуриновые или пиримидин-пиримидиновые замены, T-C и/или A-G) происходят чаще, чем трансверсии (пурин-пиримидиновые замены, T-AG C-AG и/или A-TC G-TC), `--clustalout` - задаёт формат  выходных файлов (можно брать разные, в основном программы построения деревьев едят все форматы), `--maxiterate 1000` - задаёт количество итераций (перестроек) выравнивания.

 ![image](https://github.com/user-attachments/assets/7bb0cc19-bf85-4e0c-83bc-34baefde107e)

`--thread 8` - задаёт количество парллельных потоков (чем больше потоков, тем в теории быстрее пойдёт процесс, потому что N фаайлов будут обрабатывать паралллельно, но на самом деле нет, потому что сверху эту логику ограничивает самый медленный нераспараллеленный субпроцесс - эт называется, оказывается, закон Амдала), `--auto` - программа сама автоматически подбирает оптимальный режим выравнивания. 

![image](https://github.com/user-attachments/assets/6f86174a-d0c9-4695-a91a-bbb86d3d9f26)

Вместо параметра `--kimura 1` можно использовать другие предусмотренные модели. Можно почитать их описания где-нибудь, но важно понимать какие модели в каких случаях используют. В основном это зависит от типа входных данных и того, что вы о них знаете, например разительно ли далеки последовательности по GC состав, насколько много эволюционных изменений вы предполагаете, знаете или предполагаете ли вы что-то о частоте встречаемости каждого из нуклеотидов и о потенциальной частоте (или разнице частот) замен между ними. Есть очень сложные математические модели, включающие в себя множество параметров, но мне они не нужны и даже вредны, потому что мои данные - это митохондрии, которые у всех выполняют одинаковую функцию, не меняются внешне, вообще не так уж и активно меняются в смысловом плане, поэтому мне хватит обычной можеди, которая учитывает разную частоту замен между основаниями разных типов. 
